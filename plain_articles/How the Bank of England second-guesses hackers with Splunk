
It must be every hacker’s dream to be the one to skip lightly past the cybersecurity defences of the Bank of England, leave Governor Mark Carney a snotty email, and waltz off with a few million in something negotiable worldwide, all from the comfort of the back bedroom.
In practice, of course, the more likely candidates are probably better organised, well funded, and quite possibly part of some different nation state. Either way, a good part of Jonathan Pagett’s job is to come up with the ways of stopping them.
Pagett heads up Security Operations Centre at the Bank of England and is responsible for detection and response against cyber attacks against it. That is a job very much focused on external attacks, covering the whole range of different types of cyber attacks, from denial of service, ransomware, tax return phishing, hactivist activity and anything else that has not been thought of yet. And that last part is perhaps the most important aspect of his job these days.
For the last two years his job has been centred around creating what he calls `SOC 2.0’, which describes as a very different operating model for detecting attacks. Historically, attacks have been detected by tools set up to for known attacks. There is a security alert and teams respond and try to mitigate the attack and remediate the consequences. But this process only works when it is reacting to known threats for which defences have been created. Pagett has all those tools in the Bank’s armoury, but that is a relatively small box outside of which the Bank realised it had to think:
What happens if the people who are attacking you have got money, resources and the motivation to just go after you and craft an attack that’s never been seen before? That is exactly the reason why we started the SOC 2.0 initiative. It is all around discovering online attacks.
That is the basic brief for SOC 2.0 – develop processes that can discover something when the team don’t know what it looks like. That is why Splunk was brought in as a platform to provide data mining and analysis capabilities.
What they are thinking?
The goal is to proactively try and discover attacks by looking for the behaviours associated with attacks, rather than the attacks themselves. This involves ingesting data from across all the Bank’s networks. Against this huge dataset Pagett’s team of analysts test models what behaviours attackers might demonstrate:
That’s why we need data mining and why we chose Splunk. It allows us to very quickly craft these analytics to spot those behaviours. It has allowed us to change to a proactive threat hunting operating model.
But the technology is only one piece of his plan. The other, arguably more important, part is the operating model around it. This has to be the ability of the in-house development team to change and develop models rapidly in response to attackers changing their MO. Pagett says:
Then we need to very quickly update our analytics So we don’t like buying black boxes, because you’ve got to wait for the supplier to change that. At the heart of our operating model, we spend 80% of our time just modelling the changing attacker behaviours that we get back through a whole range of threat intelligence. Then we spend time updating the analytics to stop these unknown attacks.
He also sees the operating model giving the Bank a head start to keeping staff, despite the shortage of cybersecurity professionals the world over. To his mind it gives someone the task taking a hacker, figuring out how they operate, then developing analytics for that behaviour, plus all the incident responses.
The team runs hackathons every week So so it’s kind of like a two day where the team chooses a specific threat. The hackathons target a specific actor profile, and usually lasts about two days. But each one may come up with 20 different attack profiles and associated behaviours:
Unfortunately, we’re never going to finish because the attackers are always changing, and they always keep coming up with new ways of attacking, so we have to keep doing it. It’s an endless cat and mouse game.
Much of this work is aimed at the unstructured side of Bank operations. With the main legacy systems there are established defences that already involve heavy analysis of all traffic into and out of the Bank, as well as between the existing applications. Because the tasks and the data are structured, it is possible to spot anomalies in the logs, such as unusual network calls, very quickly. It is possible to investigate, isolate, remove and, where necessary, remediate really quite quickly.
Its target is applications such as email. This is where a legitimate email can come from anywhere, and may well contain a legitimate attachment, but may just as easily be a spear-phishing, malicious attack. What matters is how that can be identified and modelled, and it is the underlying behaviour logically described, that needs to be modelled, so that the Splunk analysis tools can identify the behaviour pattern.
The classic attack here would be to send a Word attachment and convince the recipient it contains a report they need to see. When it is opened, Word performs a number of tasks and it is possible to model how those processes might be used to launch some malicious code. Alternatively, it could also happen that an individual does something different to normal practice with the attachment when it is opened; that too is worthy of modelling and investigation. Pagett explains:
Obviously, we can collect a lot of different types of data from peoples’ laptops, desktops, servers and things. And we are able to model how a laptop is being used. And because humans are strangely predictable, we can look at that device doing something quite different, for example, using the Splunk UBA behavioural analytics products. So it’s looking at machine learning models.
The team use the Kill Chain as part of the modelling. This is described as `the attacker’s cycle’ and describes the chain of events a hacker will use, from reconnaissance against the organisation all the way through to the actual attack. So they do some user modelling of the various stages so there is good defence in depth at the monitoring stage so they can spot the attack being delivered.
Share and share alike
Some organisations have difficulty convincing the Board that cybersecurity is a priority, but the Bank of England takes it pretty seriously. Pagett reckons it makes it quite a nice place to work in that respect, because it has the support of senior leadership, making the job a lot easier.
There is also a good level of collaboration with the other banks that the Bank of England has to deal with, including a lot of international cooperation at a central bank level. The team has a lot of close ties with other institutions, especially in the area of analytics development, says Pagett:
If we come up with a good way to, say, spot spear-phishing attempts, then everybody else has got the same problem. So it makes sense to collaborate.
But does that then mean that everybody has to use the same security so the software infrastructure? For Pagett, the answer is no:
An example could be the bank using Splunk, whereas another central bank might use a competing product, so the code that we develop might not be transferable. They collaborate at the logical level, and the information set covers the behaviour they are trying to detect and the logic behind it. That is where the skill is. Converting that logic into program A or program B is relatively easy, it is coming up with those ideas that we are looking for. That’s where we need skilled people.
Finding ways of defining the team’s success is an interesting problem in its own right, as they are proactively searching for behaviours in advance, rather than reactively dealing with attacks that have happened. All he would suggest was that they do find a good number of behaviour patterns are spotted, but that they are often legitimate. This does, however, prove that the analytics works:
So over the last two and a half years, we’ve developed almost 300 different types of behaviours that we look for. And most of them have actually shown something we can look at it. We call them `not a true positive’. it wasn’t a cyber-attack but was a legitimate detection.
Many of these results come from The Bank’s own Threat and Vulnerability Management team doing penetration testing, and operating what Pagett smilingly called “a diligent regime”.
 
Image credit - TwitterDisclosure - Pagett was speaking at Splunk Conf18 conference in Orlando, Florida.Read more on: Analytics planning and data analysisCloud platforms - infrastructure and architectureData privacyDigital enterprise in the real worldSecurity 